<?xml version="1.0" encoding="utf-8"?> <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> <xsl:output method="text" version="1.0" encoding="utf8" /> <xsl:template match="/diary">Title|Date|Text|Locations|People|Artworks
<xsl:for-each select="entry"> <!-- Print dates, diary text -->Diary Entry on <xsl:value-of select="date"/>|<xsl:value-of select="date"/>|<xsl:value-of select="text" />|<!-- Print all places --><xsl:for-each select="text/place"><xsl:variable name="placeID"><xsl:value-of select="@id" /></xsl:variable><xsl:variable name="placeName"><xsl:value-of select="document('../xml/locations.xml')/Document/Row[@id=$placeID]/name" /></xsl:variable><xsl:value-of select="$placeName"/>@</xsl:for-each>|<!-- Print all persons --><xsl:for-each select="text/place/person"><xsl:variable name="personID"><xsl:value-of select="@id" /></xsl:variable><xsl:variable name="personName"><xsl:value-of select="document('../xml/people.xml')/Document/Row[@id=$personID]/name" /></xsl:variable><xsl:value-of select="$personName"/>@</xsl:for-each>|<!-- Print artworks --><xsl:for-each select="text/place/artwork"><xsl:variable name="artID"><xsl:value-of select="@id" /></xsl:variable><xsl:variable name="artName"><xsl:value-of select="document('../xml/artworks.xml')/Document/Row[@id=$artID]/name" /></xsl:variable><xsl:variable name="artDate"><xsl:value-of select="document('../xml/artworks.xml')/Document/Row[@id=$artID]/date" /></xsl:variable><xsl:value-of select="$artName"/> - <xsl:value-of select="artDate" />@</xsl:for-each><xsl:text>
</xsl:text></xsl:for-each> 
</xsl:template> </xsl:stylesheet>